CREATE TABLE WAMBOLD7.PATIENT
(	PATIENTNO	CHAR(6) NOT NULL,
	PATIENTLASTNAME	VARCHAR(20),
	PATIENTFIRSTNAME VARCHAR(20),
	PATIENTCITY	VARCHAR(20),
	PATIENTSTATE	CHAR(2),
	PATIENTCELL	CHAR(10),
	PATIENTDOB	DATE,
	PATIENTGENDER	CHAR(1),
	PATIENTENROLEDATE DATE,
	CTNO		CHAR(5),
	HOSPITALNO	CHAR(6),
	PRIMARY KEY(PATIENTNO),
	FOREIGN KEY(CTNO) REFERENCES WAMBOLD7.TRACER,
	FOREIGN KEY(HOSPITALNO) REFERENCES WAMBOLD7.HOSPITAL)

CREATE TABLE WAMBOLD7.HOSPITAL
(	HOSPITALNO	CHAR(6) NOT NULL,
	HOSPITALNAME	VARCHAR(20),
	HOSPITALPHONE	CHAR(10),
	HOSPITALCOUNTY	VARCHAR(20),
	PRIMARY KEY (HOSPITALNO))

CREATE TABLE WAMBOLD7.TEST
(	TESTNO		CHAR(10) NOT NULL,
	TESTDATE	DATE,
	TESTTYPE	VARCHAR(20),
	RESULT		VARCHAR(8),
	PATIENTNO	CHAR(6),
	HOSPITALNO	CHAR(6),
	PRIMARY KEY (TESTNO),
	FOREIGN KEY (PATIENTNO) REFERENCES WAMBOLD7.PATIENT,
	FOREIGN KEY (HOSPITALNO) REFERENCES WAMBOLD7.HOSPITAL)

CREATE TABLE WAMBOLD7.TRACER
(	CTNO	CHAR(5) NOT NULL,
	LASTNAME	VARCHAR(20),
	FIRSTNAME	VARCHAR(20),
	HIREDATE	DATE,
	TRAINDATE	DATE,
	PRIMARY KEY (CTNO))

CREATE TABLE WAMBOLD7.CONTACT
(	CONTACTNO	CHAR(8) NOT NULL,
	LASTNAME	VARCHAR(20),
	FIRSTNAME	VARCHAR(20),
	CITY		VARCHAR(20),
	STATE		CHAR(2),
	CELLPHONE	CHAR(10),
	AGE		VARCHAR(3),
	CONTACTDATE	DATE,
	PATIENTNO	CHAR(6),
	INVESTNO	CHAR(6),
	PRIMARY KEY (CONTACTNO),
	FOREIGN KEY (PATIENTNO) REFERENCES WAMBOLD7.PATIENT,
	FOREIGN KEY (INVESTNO) REFERENCES WAMBOLD7.INVESTIGATOR)

CREATE TABLE WAMBOLD7.INVESTIGATOR
(	INVESTNO	CHAR(6) NOT NULL,
	LASTNAME	VARCHAR(20),
	FIRSTNAME	VARCHAR(20),
	PAYRATE		NUMBER(7,2),
	PRIMARY KEY (INVESTNO))

CREATE TABLE WAMBOLD7.CALLS
(	PATIENTNO	CHAR(6) NOT NULL,
	CTNO		CHAR(5) NOT NULL,
	CALLDATE	DATE NOT NULL,
	OUTCOME		VARCHAR(8),
	PRIMARY KEY (PATIENTNO, CTNO, CALLDATE))

1)
SELECT A.PATIENTLASTNAME, A.PATIENTFIRSTNAME, A.PATIENTCITY, A.PATIENTDOB, A.PATIENTENROLEDATE, B.HOSPITALNAME, B.HOSPITALCOUNTY
FROM WAMBOLD7.PATIENT A, WAMBOLD7.HOSPITAL B
WHERE A.HOSPITALNO = B.HOSPITALNO
AND PATIENTDOB <  DATE'1969-11-01'

2)
SELECT CTNO, LASTNAME, FIRSTNAME, HIREDATE, TRAINDATE
FROM WAMBOLD7.TRACER
WHERE TRAINDATE - HIREDATE <= 10

3)
SELECT A.PATIENTLASTNAME, A.PATIENTFIRSTNAME, B.LASTNAME, B.FIRSTNAME, B.CONTACTDATE, B.AGE
FROM WAMBOLD7.PATIENT A, WAMBOLD7.CONTACT B
WHERE A.PATIENTNO = B.PATIENTNO
AND B.AGE <= 18

4)
SELECT A.PATIENTLASTNAME, A.PATIENTFIRSTNAME, B.HOSPITALNAME, C.TESTDATE, C.TESTTYPE, C.RESULT
FROM WAMBOLD7.PATIENT A, WAMBOLD7.HOSPITAL B, WAMBOLD7.TEST C
WHERE A.HOSPITALNO = B.HOSPITALNO
AND C.PATIENTNO = A.PATIENTNO
ORDER BY C.TESTDATE
      
5)
SELECT A.INVESTNO, COUNT(B.AGE), AVG(B.AGE)
FROM WAMBOLD7.INVESTIGATOR A, WAMBOLD7.CONTACT B 
WHERE A.INVESTNO = B.INVESTNO
GROUP BY A.INVESTNO

6)
SELECT A.LASTNAME, A.FIRSTNAME, B.PATIENTLASTNAME, B.PATIENTFIRSTNAME, B.PATIENTCELL, C.CALLDATE, C.OUTCOME
FROM WAMBOLD7.TRACER A, WAMBOLD7.PATIENT B, WAMBOLD7.CALLS C
WHERE A.CTNO = B.CTNO
AND A.CTNO = C.CTNO
AND B.PATIENTNO = C.PATIENTNO
ORDER BY B.PATIENTLASTNAME, C.CALLDATE

7)
SELECT A.PATIENTLASTNAME, A.PATIENTFIRSTNAME, B.LASTNAME, B.FIRSTNAME, B.CITY, B.CONTACTDATE
FROM WAMBOLD7.PATIENT A, WAMBOLD7.CONTACT B
WHERE A.PATIENTCITY = B.CITY

8)
SELECT HOSPITALNAME, HOSPITALPHONE, HOSPITALCOUNTY
FROM WAMBOLD7.HOSPITAL
WHERE HOSPITALNO = '882331'

9)
SELECT INVESTNO, PATIENTCOUNT
FROM 
( SELECT A.INVESTNO, COUNT(B.AGE) AS "PATIENTCOUNT"
FROM WAMBOLD7.INVESTIGATOR A, WAMBOLD7.CONTACT B 
WHERE A.INVESTNO = B.INVESTNO
GROUP BY A.INVESTNO )
WHERE PATIENTCOUNT > 3


10)
SELECT LASTNAME, FIRSTNAME
FROM WAMBOLD7.INVESTIGATOR
WHERE INVESTNO IN
	( SELECT INVESTNO
	  FROM WAMBOLD7.CONTACT
	  WHERE STATE = 'WI'
	  AND INVESTNO IN
		(SELECT INVESTNO
		 FROM WAMBOLD7.CONTACT
		 WHERE STATE ='IL')
	